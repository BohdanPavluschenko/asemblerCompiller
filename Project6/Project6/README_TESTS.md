# Тести та виправлення помилок

## Виправлені помилки

### 1. Подвійний виклик _pclose()
**Проблема**: У функціях `findMasmPath()` та `findClPath()` був подвійний виклик `_pclose(pipe)`, що могло призвести до помилки.

**Виправлення**: Додано перевірку - `_pclose()` викликається лише один раз.

### 2. Відсутні перевірки меж масивів
**Проблема**: У функції `generateASM()` не було перевірок на достатність елементів у `stmt.args` перед доступом.

**Виправлення**: Додано перевірки `stmt.args.size() >= 3` перед доступом до індексів.

### 3. Неправильна обробка від'ємних чисел
**Проблема**: Перевірка `isdigit(value[0])` не враховувала від'ємні числа.

**Виправлення**: Додано перевірку на від'ємні числа: `isdigit(value[0]) || (value[0] == '-' && value.size() > 1 && isdigit(value[1]))`.

### 4. Відсутні повідомлення про помилки
**Проблема**: При відсутності змінних у таблиці символів не виводилися попередження.

**Виправлення**: Додано повідомлення про помилки з номером рядка.

## Запуск тестів

### Компіляція тестів
```bash
cl.exe /EHsc test_assembler.cpp /Fe:test_assembler.exe
```

### Запуск тестів
```bash
test_assembler.exe
```

## Структура тестів

Тести покривають наступні області:

1. **testLexer()** - тестування лексера (розбір токенів)
2. **testParser()** - тестування парсера (розбір інструкцій)
3. **testAssemblyConversion()** - тестування конвертації асемблера
4. **testErrorHandling()** - тестування обробки помилок
5. **testUtilityFunctions()** - тестування допоміжних функцій
6. **testSafety()** - тестування безпеки (перевірки меж, nullptr)

## Додаткові перевірки

Код тепер включає:
- Перевірки меж масивів перед доступом
- Перевірки на nullptr перед використанням вказівників
- Обробку від'ємних чисел
- Детальні повідомлення про помилки з номерами рядків
- Правильне закриття файлових дескрипторів

## Рекомендації

1. Завжди запускайте тести після змін у коді
2. Перевіряйте вихід тестів перед комітом
3. Додавайте нові тести для нових функцій

